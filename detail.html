<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Kumpulan Semua Postingan</title>

<style>
:root{
  --bg:#0f172a;
  --card:#1e293b;
  --text:#f1f5f9;
  --accent:#2563eb;
}

body{
  margin:0;
  background:var(--bg);
  color:var(--text);
  font-family:Arial, sans-serif;
}

header{
  padding:20px;
  font-size:22px;
  font-weight:bold;
}

.grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(180px,1fr));
  gap:18px;
  padding:20px;
}

.card{
  background:var(--card);
  border-radius:10px;
  overflow:hidden;
  cursor:pointer;
  transition:.3s;
  position:relative;
}

.card:hover{
  transform:scale(1.05);
}

.card img{
  width:100%;
  height:260px;
  object-fit:cover;
  display:block;
}

.card-title{
  padding:10px;
  font-size:14px;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}

/* Overlay play icon */
.play-icon{
  position:absolute;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  font-size:40px;
  opacity:0;
  transition:.3s;
}

.card:hover .play-icon{
  opacity:1;
}

.next-wrapper{
  text-align:center;
  padding:20px;
}

.next-btn{
  background:var(--accent);
  color:white;
  border:none;
  padding:10px 25px;
  border-radius:8px;
  cursor:pointer;
  font-size:14px;
}
</style>
</head>

<body>

<header>ðŸ“º Kumpulan Semua Postingan</header>

<div class="grid" id="grid"></div>

<div class="next-wrapper">
  <button class="next-btn" id="nextBtn">Next</button>
</div>

<script>
let allPosts = [];
let currentPage = 0;
const perPage = 12;

async function load(){
  try{
    const res = await fetch("/videos", { cache: "no-store" });
    const json = await res.json();

    allPosts = Object.entries(json).reverse();
    render();

  }catch(e){
    document.getElementById("grid").innerHTML="Gagal memuat data.";
  }
}

function render(){
  const grid = document.getElementById("grid");
  grid.innerHTML = "";

  const start = currentPage * perPage;
  const end = start + perPage;
  const slice = allPosts.slice(start, end);

  if(!slice.length){
    document.getElementById("nextBtn").style.display="none";
    return;
  }

  slice.forEach(([key, post]) => {

    const title = post.title || post.name || "No Title";

    // WAJIB ADA IMAGE DI DATA AGAR TIDAK KOSONG
    const thumbnail =
      post.thumbnail ||
      post.thumb ||
      post.image ||
      "https://via.placeholder.com/300x450?text=No+Poster";

    const div = document.createElement("div");
    div.className="card";

    div.innerHTML=`
      <img src="${thumbnail}">
      <div class="play-icon">â–¶</div>
      <div class="card-title">${title}</div>
    `;

    div.onclick=()=>location.href=`index.html?id=${key}`;

    grid.appendChild(div);
  });
}

document.getElementById("nextBtn").onclick=()=>{
  currentPage++;
  render();
};

load();
</script>

<!-- IKLAN -->
<script>
(function(s){
  s.dataset.zone='9713245';
  s.src='https://al5sm.com/tag.min.js';
})
([document.documentElement, document.body]
.filter(Boolean).pop()
.appendChild(document.createElement('script')))
</script>

</body>
</html>
