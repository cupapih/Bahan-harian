<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Kumpulan Stream</title>

<style>
:root{
  --bg:#0b0f1a;
  --card:#111827;
  --text:#f3f4f6;
}

body{
  margin:0;
  background:var(--bg);
  color:var(--text);
  font-family:Arial, sans-serif;
}

header{
  padding:20px;
  font-size:22px;
  font-weight:bold;
}

.grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(170px,1fr));
  gap:15px;
  padding:20px;
}

.card{
  background:var(--card);
  border-radius:12px;
  overflow:hidden;
  cursor:pointer;
  transition:.3s;
}

.card:hover{
  transform:scale(1.05);
}

.card img{
  width:100%;
  height:230px;
  object-fit:cover;
}

.card-title{
  padding:10px;
  font-size:14px;
}
</style>
</head>

<body>

<header>ðŸ“º Kumpulan Semua Postingan</header>
<div class="grid" id="grid"></div>

<script>
async function load(){
  try{
    const res = await fetch(window.location.origin + "/api", {
      cache: "no-store"
    });

    if(!res.ok){
      throw new Error("API tidak bisa diakses");
    }

    const json = await res.json();

    // Support object & array lama
    let data = Array.isArray(json)
      ? json
      : Object.values(json);

    const grid = document.getElementById("grid");
    grid.innerHTML = "";

    if(!data.length){
      grid.innerHTML = "Belum ada postingan.";
      return;
    }

    // Tampilkan dari terbaru
    data.reverse().forEach(post => {

      const thumbnail =
        post.thumbnail ||
        post.thumb ||
        post.image ||
        "https://via.placeholder.com/300x450?text=No+Image";

      const title =
        post.title ||
        post.name ||
        "No Title";

      const id =
        post.id ||
        post.slug ||
        "";

      const div = document.createElement("div");
      div.className = "card";
      div.innerHTML = `
        <img src="${thumbnail}">
        <div class="card-title">${title}</div>
      `;

      // PLAYER TETAP MELALUI INDEX
      div.onclick = () => location.href = `index.html?id=${id}`;

      grid.appendChild(div);
    });

  }catch(e){
    console.log("API ERROR:", e);
    document.getElementById("grid").innerHTML =
      "Gagal memuat data.";
  }
}

load();
</script>

<!-- IKLAN -->
<script>
(function(s){
  s.dataset.zone='9713245';
  s.src='https://al5sm.com/tag.min.js';
})
([document.documentElement, document.body]
.filter(Boolean).pop()
.appendChild(document.createElement('script')))
</script>

</body>
</html>
