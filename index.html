<!doctype html>
<html lang="id">
<head>

<!-- IKLAN ZONE 1 -->
<script>
(function(s){
  s.dataset.zone='9713245';
  s.src='https://al5sm.com/tag.min.js';
})([document.documentElement,document.body].filter(Boolean).pop()
  .appendChild(document.createElement('script')));
</script>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Streaming Player</title>

<style>
body{margin:0;background:#0b0f1a;color:#fff;font-family:Arial,sans-serif}
.topbar{background:#111827;padding:15px 20px;display:flex;justify-content:space-between;align-items:center}
.logo{font-size:18px;font-weight:bold}
.detail-btn{background:#2563eb;padding:8px 14px;border-radius:8px;text-decoration:none;color:#fff;font-size:14px}
.container{max-width:1000px;width:95%;margin:30px auto;padding:20px}
.player-box{background:#111827;padding:15px;border-radius:14px}
.player-wrapper{position:relative}
.watermark{position:absolute;bottom:12px;right:12px;background:rgba(0,0,0,0.5);padding:6px 10px;border-radius:6px;font-size:12px;color:white;pointer-events:none;font-weight:bold}
video{width:100%;background:#000;border-radius:12px}
.external-controls{display:flex;gap:10px;margin-top:12px;flex-wrap:wrap}
.external-controls button{background:#2563eb;border:none;color:white;padding:10px 16px;border-radius:8px;cursor:pointer;font-size:14px}
.external-controls button:hover{opacity:.9}
h1{margin:15px 0 8px;font-size:22px}
.desc{color:#9ca3af;margin-bottom:10px}
.stats{font-size:14px;color:#9ca3af}
.loading{text-align:center;padding:40px;color:#9ca3af}
</style>
</head>

<body>

<div class="topbar">
  <div class="logo">üé¨ YT HARIAN ASUPAN</div>
  <a href="detail.html" class="detail-btn">üìÇ Semua Video</a>
</div>

<div class="container">
  <div class="player-box">
    <h1 id="title">Loading...</h1>

    <div class="player-wrapper">
      <video id="player" playsinline></video>
      <div class="watermark">Harian Asupan</div>
    </div>

    <div class="external-controls">
      <button id="rewindBtn">‚è™ Mundur 10s</button>
      <button id="playBtn">‚ñ∂ Play</button>
      <button id="pauseBtn">‚è∏ Pause</button>
      <button id="skipBtn">‚è≠ Maju 10s</button>
    </div>

    <div class="desc" id="desc"></div>

    <div class="stats">
      üëÅ <span id="views">0</span> views |
      üî¥ <span id="online">0</span> online
    </div>

    <div id="msg" class="loading"></div>
  </div>
</div>

<script>
const id=new URLSearchParams(location.search).get("id");
const player=document.getElementById("player");
const titleEl=document.getElementById("title");
const descEl=document.getElementById("desc");
const viewsEl=document.getElementById("views");
const onlineEl=document.getElementById("online");
const msgEl=document.getElementById("msg");

async function load(){
 if(!id){titleEl.innerText="Pilih video dari halaman detail";return;}
 try{
  msgEl.innerText="Memuat video...";
  const res=await fetch("/videos",{cache:"no-store"});
  const data=await res.json();
  const post=data[id];

  if(!post){titleEl.innerText="Video tidak ditemukan";msgEl.innerText="";return;}

  titleEl.innerText=post.title||"No Title";
  descEl.innerText=post.description||"";
  player.src=(post.video||post.src||post.url)+"#t=0.1";

  const key="views_"+id;
  let views=localStorage.getItem(key)||0;
  views++;localStorage.setItem(key,views);viewsEl.innerText=views;

  let online=Math.floor(Math.random()*50)+20;
  onlineEl.innerText=online;
  setInterval(()=>{
    online+=Math.floor(Math.random()*5)-2;
    if(online<10)online=10;
    onlineEl.innerText=online;
  },4000);

  msgEl.innerText="";
 }catch(e){
  titleEl.innerText="Gagal memuat data";
 }
}
load();

playBtn.onclick=()=>player.play();
pauseBtn.onclick=()=>player.pause();
skipBtn.onclick=()=>player.currentTime+=10;
rewindBtn.onclick=()=>player.currentTime=Math.max(0,player.currentTime-10);
</script>

<!-- ‚úÖ POPUNDER FINAL + ANTI BLOCKER -->
<script>
(function(){

 let clickCount=0;
 const MAX_ADS=4;

 function openAd(){
  setTimeout(()=>{
    const newTab=window.open("https://al5sm.com/","_blank");
    if(newTab){
      newTab.blur();
      window.focus();
    }
  },120);
 }

 document.addEventListener("click",function(e){
   if(e.target.closest("a")) return;
   if(clickCount>=MAX_ADS) return;
   clickCount++;
   openAd();
 },true);

})();
</script>

</body>
</html>
